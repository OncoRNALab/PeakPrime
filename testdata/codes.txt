samtools view -h -F 2308 /user/gent/446/vsc44685/ScratchVO_dir/OncoRNA_peakprime/Primer_PeakFindR/testdata/Merged_S7_S12.bam \
| awk 'BEGIN{OFS="\t"} /^@/ || $0 ~ /\tNH:i:1(\t|$)/' \
| samtools view -@8 -b -o /user/gent/446/vsc44685/ScratchVO_dir/OncoRNA_peakprime/Primer_PeakFindR/testdata/Merged_S7_S12.unique.bam -



p <- plot_window_with_primer(
  gene_id   = "ENSG00000008988",
  bw        = "./results/high/Merged_S7_S12.bw",
  gtf       = "/data/gent/vo/000/gvo00027/resources/Ensembl_transcriptomes/Homo_sapiens/GRCh38/Homo_sapiens.GRCh38.109.chrIS_spikes_45S.gtf",
  peaks_tsv = "./results/high/peaks.tsv",
  primer_bed = "./results/high/primer_targets.bed",   # optional if you have it now
  qc_tsv     = "./results/high/qc_coverage_summary.tsv",
  slop       = 0,     # the window is already what you selected; set >0 if you want a little context
  log10_y    = FALSE
)
print(p)
ggsave(sprintf("plot_%s.png", "ENSG00000008988"), p, width = 8, height = 4.5, dpi = 300)


chmod +x ./bin/MakePlots.R


Rscript ./bin/MakePlots_new.R \
  --gene ENSG00000122566 \
  --bw ./results/high/Merged_S7_S12.bw \
  --gtf /data/gent/vo/000/gvo00027/resources/Ensembl_transcriptomes/Homo_sapiens/GRCh38/Homo_sapiens.GRCh38.109.chrIS_spikes_45S.gtf \
  --peaks ./results/high/peaks.tsv \
  --qc ./results/high/qc_coverage_summary.tsv \
  --primer ./results/high/primer_targets.bed \
  --yaxis depth \
  --out ENSG00000122566_GPT5_high.png



chmod +x ./bin/MakePlots.R

Rscript ./bin/MakePlots_new.R \
  --gene ENSG00000034510 \
  --bw ./results/Class1_test/Merged_S7_S12.bw \
  --gtf /data/gent/vo/000/gvo00027/resources/Ensembl_transcriptomes/Homo_sapiens/GRCh38/Homo_sapiens.GRCh38.109.chrIS_spikes_45S.gtf \
  --peaks ./results/Class1_test/peaks.tsv \
  --qc ./results/Class1_test/qc_coverage_summary.tsv \
  --primer ./results/Class1_test/primer_targets.bed \
  --yaxis percent \
  --out ENSG00000034510_prct_class1.png


  Rscript ./bin/MakePlots_new.R \
  --gene ENSG00000034510 \
  --bw ./results/Class1_WM30/Merged_S7_S12.bw \
  --gtf /data/gent/vo/000/gvo00027/resources/Ensembl_transcriptomes/Homo_sapiens/GRCh38/Homo_sapiens.GRCh38.109.chrIS_spikes_45S.gtf \
  --peaks ./results/Class1_WM30/peaks.tsv \
  --qc ./results/Class1_WM30/qc_coverage_summary.tsv \
  --primer ./results/Class1_WM30/primer_targets.bed \
  --yaxis depth \
  --out ENSG00000034510_depth_class1WM30.png

Rscript ./bin/MakePlots_new.R \
  --gene ENSG00000089009 \
  --bw ./results/Class1_W30_pad100_uniqBAM/Merged_S7_S12.unique.bw \
  --gtf /data/gent/vo/000/gvo00027/resources/Ensembl_transcriptomes/Homo_sapiens/GRCh38/Homo_sapiens.GRCh38.109.chrIS_spikes_45S.gtf \
  --peaks ./results/Class1_W30_pad100_uniqBAM/peaks.tsv \
  --qc ./results/Class1_W30_pad100_uniqBAM/qc_coverage_summary.tsv \
  --primer ./results/Class1_W30_pad100_uniqBAM/primer_targets.bed \
  --yaxis percent \
  --out ENSG00000089009_prct_Class1.png

Rscript ./bin/MakePlots_new.R \
  --gene ENSG00000125835 \
  --bw ./results/Class2_W30_pad100/Merged_S7_S12.unique.bw \
  --gtf /data/gent/vo/000/gvo00027/resources/Ensembl_transcriptomes/Homo_sapiens/GRCh38/Homo_sapiens.GRCh38.109.chrIS_spikes_45S.gtf \
  --peaks ./results/Class2_W30_pad100/peaks.tsv \
  --qc ./results/Class2_W30_pad100/qc_coverage_summary.tsv \
  --primer ./results/Class2_W30_pad100/primer_targets.bed \
  --yaxis depth \
  --out ENSG00000125835_prct_Class2W30pad100.png

ENSG00000041357

python ./bin/select_best_primer.py \
    --report results/Class1_test/primer_alignment_report.tsv \
    --summary results/Class1_test/primer_alignment_summary.tsv \
    --out best_primers_normal.tsv

  Rscript ./bin/MakePlots_new.R \
  --gene ENSG00000034510 \
  --bw ./results/Class1_test/Merged_S7_S12.bw \
  --gtf /data/gent/vo/000/gvo00027/resources/Ensembl_transcriptomes/Homo_sapiens/GRCh38/Homo_sapiens.GRCh38.109.chrIS_spikes_45S.gtf \
  --peaks ./results/Class1_test/peaks.tsv \
  --qc ./results/Class1_test/qc_coverage_summary.tsv \
  --primer ./results/Class1_test/primer_targets.bed \
  --out ENSG00000034510_class1.png


Rscript ./bin/MakePlots.R \
  --gene ENSG00000122566 \
  --bw ./results/high/Merged_S7_S12.bw \
  --gtf /data/gent/vo/000/gvo00027/resources/Ensembl_transcriptomes/Homo_sapiens/GRCh38/Homo_sapiens.GRCh38.109.chrIS_spikes_45S.gtf \
  --peaks ./results/high/peaks.tsv \
  --qc ./results/high/qc_coverage_summary.tsv \
  --primer ./results/high/primer_targets.bed \
  --out ENSG00000122566_high.png

Rscript ./bin/MakePlots.R \
  --gene ENSG00000008988 \
  --bw ./results/med/Merged_S7_S12.bw \
  --gtf /data/gent/vo/000/gvo00027/resources/Ensembl_transcriptomes/Homo_sapiens/GRCh38/Homo_sapiens.GRCh38.109.chrIS_spikes_45S.gtf \
  --peaks ./results/med/peaks.tsv \
  --qc ./results/med/qc_coverage_summary.tsv \
  --primer ./results/med/primer_targets.bed \
  --yaxis depth \
  --out ENSG00000008988_med.png


  cat /data/gent/vo/000/gvo00027/resources/Ensembl_transcriptomes/Homo_sapiens/GRCh38/Homo_sapiens.GRCh38.109.chrIS_spikes_45S.fa | grep ENST00000357146
  
  


  
>ENSG00000197170|17:67340726-67340839(-)
TCTTAGTGCTTTAGAAAAAAGTTAAAATTGGAAGTCATTAAAAAAAGACTGTTATAATGGTGTATATGTTGGGGTTTTTT
TTCTAAGCTTCTTTGTCTTAAATTTTAAAATAGT [GTAAAACGACGGCCAG] does not exist in any transcript

TCTTAGTGCTTTAGAAAAAAGTTAAAATTGGAAGTCATTAAAAAAAGACTGTTATAATGGTGTATATGTTGGGGTTTTTT
TTCTAAGCTTCTTTGTCTTAAATTTTAAAATAGTGTAAAACGACGGCCAG


GAATATGTTTGAGACTCCCTTTGACC TTTCAGTTCCCCAAGTTCATTGTTAACTTTGCATTTGC
GAATATGTTTGAGACTCCCTTTGACC


Rscript ./bin/utils_extractseq.R /data/gent/vo/000/gvo00027/resources/Ensembl_genomes/Homo_sapiens/GRCh38/Homo_sapiens.GRCh38.dna.primary_assembly.chrIS_spikes_45S.fa 17 67340726 67340839

nextflow run primer3.nf -profile local --fasta "/user/gent/446/vsc44685/ScratchVO_dir/OncoRNA_peakprime/Primer_PeakFindR/testdata/test_target.fa" --primer3_settings 'config/primer3_settings.txt'

SEQUENCE_PRIMER_REVCOMP=CTGGCCGTCGTTTTAC
SEQUENCE_PRIMER_REVCOMP=CTGGCCGTCGTTTTAC
universal_seq <- "GTAAAACGACGGCCAG"




nextflow run main.nf -profile local \
  --bam ./testdata/Merged_S7_S12.unique.bam \
  --fasta /data/gent/vo/000/gvo00027/resources/Ensembl_genomes/Homo_sapiens/GRCh38/Homo_sapiens.GRCh38.dna.primary_assembly.chrIS_spikes_45S.fa \
  --gtf /data/gent/vo/000/gvo00027/resources/Ensembl_transcriptomes/Homo_sapiens/GRCh38/Homo_sapiens.GRCh38.109.chrIS_spikes_45S.gtf \
  --genes ./testdata/Class1_filt.txt \
  --pad 100 \
  --smooth_k 31 \
  --sliding_window true \
  --min_window_mean_pct 30 \
  --max_gap 10 \
  --trim_low_coverage_pct 20 \
  --min_exonic_fraction 0.9 \
  --trim_to_exon true \
  --primer3_settings config/primer3_settings.txt \
  --transcriptome_index /data/gent/vo/000/gvo00027/resources/Bowtie2_index/Homo_sapiens/Transcriptome_Homo_sapiens.GRCh38.109.chrIS_spikes_45S/bowtie2_index \
  --transcriptome_fasta /data/gent/vo/000/gvo00027/resources/Ensembl_transcriptomes/Homo_sapiens/GRCh38/Homo_sapiens.GRCh38.109.chrIS_spikes_45S.fa \
  --outdir results/Class1_W30_pad100_uniqBAM