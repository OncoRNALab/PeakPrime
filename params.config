params {
  // === Peak-based primer design mode (default) ===
  bam                 = null        // input RNA‑seq BAM (spliced alignments)
  gtf                 = null        // gene annotation (same build as BAM)
  genes               = null        // text file: one Ensembl gene ID per line
  genome_package      = 'BSgenome.Hsapiens.UCSC.hg38' // choose the genome that matches the bam file, Bioconductor genome
  fasta               = null        // optional: genome FASTA file (alternative to BSgenome)
  
  // === Distance-based primer design mode ===
  distance_mode       = false       // enable distance-based 3' end primer design (alternative to peak-based mode)
  template_length     = null        // number of bases to extract from 3' end for primer design (required for distance_mode)
  transcript_fasta    = null        // optional: FASTA file with transcript sequences (alternative to fetching from Ensembl)

  min_window_mean     = null        // minimum required mean coverage across window (absolute value)
  min_window_mean_pct = null        // minimum window mean as % of gene peak coverage (overrides min_window_mean)
  max_gap             = null        // maximum allowed longest zero-coverage run (null to disable)
  search_slop         = 1000        // extra bases for BigWig import per chromosome
  trim_to_exon        = false       // trim final window to the exon containing the peak
  min_exonic_fraction = null        // minimum required exonic fraction of window (0-1)
  
  // New parameters for forced exonic trimming
  force_exonic_trimming = true      // force trimming to exon+UTR boundaries for primer safety
  min_trimmed_length = 30          // minimum length of trimmed region for primer design (bp)
  
  // === Primer specificity checking (both modes) ===
  transcriptome_index = null        // bowtie2 index prefix for human transcriptome (e.g., 'transcriptome_idx')
  transcript_mapping  = 'resources/transcript_gene_mapping.GRCh38.109.tsv' // transcript-to-gene mapping TSV for alignment analysis
  max_primers_per_gene = 20          // maximum primers per gene for alignment QC
  primer3_settings    = 'config/primer3_settings.txt' // default settings
  
  // Primer specificity filtering (alignment-based QC)
  distance_threshold = 400          // maximum distance from 3' end for alignments (bp)
                                    // For 3' RNA-seq, only alignments near transcript 3' end matter
  max_mismatches = 3                // maximum mismatches for primer specificity check (0-3)
                                    // Primers aligning to off-targets with ≤3 mismatches are flagged as non-specific
  bowtie2_seed_length = 12          // Bowtie2 seed length for alignment sensitivity (4-31)
                                    // 10bp = optimal for ~20nt primers to detect 1-3 mismatch alignments but very slow
  
  // MACS2-specific parameters (current implementation)
  // Note: This pipeline uses MACS2 for statistically rigorous peak calling
  // Legacy derfinder-based parameters (pad, smooth_k, sliding_window, trim_low_coverage_pct) 
  // are no longer used in the current MACS2-based workflow
  macs2_qvalue_threshold = 0.05     // q-value (FDR) threshold for peak significance (controls both MACS2 calling and pipeline filtering)
  macs2_pvalue_threshold = null     // DEPRECATED: Use macs2_qvalue_threshold instead (maintained for backward compatibility)
  macs2_min_peak_score = 0          // minimum peak score threshold
  macs2_extsize = null              // fragment size for extending reads (--extsize, null for auto-detection)
  macs2_shift = null                // shift for reads in bp (--shift, null for auto-detection)
  peak_selection_metric = 'score'   // metric for selecting best peak per gene: 'score' or 'qvalue'
  peak_rank = 1                     // which ranked peak to select per gene: 1 for best, 2 for second-best, etc.
  
  // === Multi-peak mode parameters ===
  // Multi-peak mode parameters
  select_all_peaks = false          // enable multi-peak mode: select ALL peaks per gene instead of single peak
  max_peaks_per_gene = 0            // limit peaks per gene in multi-peak mode (0=unlimited)
  
  // Multi-peak optimization parameters
  optimize_multipeak = false        // enable multi-peak primer optimization with distance-based scoring
  primers_per_gene = 3              // number of primers to select per gene in multi-peak mode
  distance_weight = 0.5             // weight for distance to 3' end in scoring (0-1)
  isoform_weight = 0.3              // weight for isoform coverage in scoring (0-1)
  peak_rank_weight = 0.2            // weight for peak rank in scoring (0-1)
  max_peaks_per_gene = 0            // limit number of peaks per gene in multi-peak mode (0=unlimited)
  
  outdir              = 'results'
  makeplots = false //by default skip ploting coverage
  
  // Parameters for makeplots workflow (when using --makeplots)
  bw                  = null        // BigWig file for plotting (required for --makeplots)
  peaks_tsv           = null        // peaks.tsv file (required for --makeplots)
  primer              = null        // primer targets BED file (optional for --makeplots, also accepts --primer_targets_bed)
  qc_tsv              = null        // QC summary file (optional for --makeplots)
  narrowpeak          = 'NO_FILE'   // MACS2 narrowPeak file to show all peaks (use 'NO_FILE' to disable)
}
